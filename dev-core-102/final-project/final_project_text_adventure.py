def main():
    victories = set()
    while True:
        print("Вступление")
        print("""Ты Сато Казума, переродившийся в другом мире подросток. Вставший искателем прилючении вместе с богиней Аква, выбранной в качестве супер-силы. В ходе жизни в городе Аксель собрал постоянное пати из четырех человек. 
У каждого персонажа индивидуальные способности.
Казума - Стратег и имеет низкоуровневые способности
Аква - Божественная сила воды
Мегумин - Взрывная магия
Даркнес - Непробиваемый рыцарь 
При встрече с врагом нужно выбрать персонажа, который будет атаковать. Для каждого генерала есть контрпик из пати, при неверном выборе победит генерал.
В гильдии поднялся переполох. Всех просят собраться перед воротами в город. """)

        input("\nНажми Enter, чтобы продолжить...")

        while True:

            print("\nВыбор действия:")
            print("1. Выйти к воротам Акселя")
            print("2. Город Арканлетия")
            print("3. Исследовать подземелье")
            print("4. Выход")

            choice = input("Введите номер действия: ")

            if choice == "1" and "dullahan" not in victories:
                if fight_dullahan():
                    victories.add("dullahan")
            elif choice == "2" and "hanzo" not in victories:
                if fight_hanzo():
                    victories.add("hanzo")
            elif choice == "3" and "vanilka" not in victories:
                if fight_vanilka():
                    victories.add("vanilka")
            elif choice == "4":
                break

            else:
                print(
                    "\nЭтот сценарий уже исследован или неверный выбор. Попробуйте снова.")
                continue

            if len(victories) == 3:
                print("Поздравляем! Вы прошли все сценарии!")
                break

            unexplored_scenarios(victories)

        break


def fight_dullahan():
    while True:
        print("\nПеред вратами в город Аксель со своим войском нежити стоит один из генералов владыки тьмы, всадник без головы Далахан.")

        print("\nВыбрать кто будет сражаться:")
        print("1. Казума")
        print("2. Аква")
        print("3. Мегумин")
        print("4. Даркнес")

        choice = input("Введите номер персонажа: ")

        if choice == "1":
            print("\nКазума с удачей 100% стреляет из лука и попадает прямо в Далахана. Но Далахан - нежить, урона нет. Армия нежити врывается в город. Поражение.")
        elif choice == "2":
            print(
                "\nАква кастует 'Божественное погребение нежити'. Армия нежити смыта, души упокоены. Победа!")
            return True
        elif choice == "3":
            print("\nМегумин кастует 'Супер-мега взрыв 3000'. Армия нежити уничтожена, но город тоже. Никто не выжил. Поражение.")
        elif choice == "4":
            print("\nДаркнес размахивает мечом, но ни разу не попадает. Далахан применяет 'Проклятие'. Даркнес обездвижена. Армия нежити врывается в город. Поражение.")
        else:
            print("\nНеверный выбор. Попробуйте снова.")
            continue
        return False


def fight_hanzo():
    while True:
        print("""Вы убегаете в другой город Арканлетия. Это город горячих источников, в котором жители вербуют всех в свою церковь. 
Ваше пати несколько дней отдыхают. Вы уходите в горы на источники и вскоре вы встречаете генерала владыки тьмы слизь Ханзо. 
Слизь начинает отправлять всю воду в источниках. """)

        print("\nВыбрать кто будет сражаться:")
        print("1. Казума")
        print("2. Аква")
        print("3. Мегумин")
        print("4. Даркнес")

        choice = input("Введите номер персонажа: ")

        if choice == "1":
            print(
                "\nКазума наносит удар катаной. Слизь Хонзо легко восстанавливает своё тело и съедает Казуму. Заодно съедает всех в пати, всех горожан, и отравляет всю воду. Поражение.")
        elif choice == "2":
            print(
                "\nАква кастует ""Божественный хук"" - волну святой воды. Но слизь сама состоит из воды. Урона не нанесено. Слизь Хонзо съедает Казуму. Заодно съедает всех в пати, всех горожан, и отравляет всю воду. Поражение.")
        elif choice == "3":
            print(
                "\nМегумин кастует ""Супер-мега взрыв 3000"". Взрыв попадает по слизи. Из-за большой взрывной волны тело Ханзо разнеслось кусочками по округе. Ханзо не может восстановить свое тело и убегает одним из своих кусочков из города.  Победа!")
            return True
        elif choice == "4":
            print(
                "\nДаркнес наносит удар мечом. Слизь Хонзо легко восстанавливает своё тело и съедает Даркнес. Заодно съедает всех в пати, всех горожан, и отравляет всю воду. Поражение.")
        else:
            print("\nНеверный выбор. Попробуйте снова.")
            continue
        return False


def fight_vanilka():
    while True:
        print("""Вы переноситесь в подземелье. В глубине вы встречаете одного из генералов владыки тьмы Ванильку. 
Он является демоном, питающийся эмоциями людей и читающий их мысли. Ванилька атакует Даркнес, 
вселившись в нее в форме маски и управляя ее телом. Даркнес, обладая усиленными сопротивлениями к магии и 
физическому урону, выбегает из подземелья. На выходе вам придется сражаться с Ванилькой в теле Даркнес. """)

        print("\nВыбрать кто будет сражаться:")
        print("1. Казума")
        print("2. Аква")
        print("3. Мегумин")

        choice = input("Введите номер персонажа: ")

        if choice == "1":
            print(
                "\nКазума применяет магию огня и попадает прямо в маску. Но урона слишком мало и демон в теле Даркнес разносит ваше пати. Поражение.")
        elif choice == "2":
            print(
                "\nАква кастует ""Очищение"" - среднюю волну воды. Но Ванилька в теле Даркнес уворачивается от атаки и потом разносит ваше пати. Поражение.")
        elif choice == "3":
            print(
                "\nМегумин кастует ""Супер-мега взрыв 999"" на Даркнес. Маска сжигается от такого взрыва. Даркнес из-за усиленного сопротивления лежит без сознания, но осталась жива. Победа!")
            return True
        else:
            print("\nНеверный выбор. Попробуйте снова.")
            continue
        return False


def unexplored_scenarios(victories):
    while True:
        remaining = []
        if "dullahan" not in victories:
            remaining.append("1. Город Аксель")
        if "hanzo" not in victories:
            remaining.append("2. Город Арканлетия")
        if "vanilka" not in victories:
            remaining.append("3. Исследовать подземелье")

        if not remaining:
            print("Все сценарии уже исследованы!")
            break

        print("\nНеисследованные сценарии:")
        for option in remaining:
            print(option)

        choice = input("Введите номер действия: ")

        if choice == "1" and "dullahan" not in victories:
            if fight_dullahan():
                victories.add("dullahan")
                break
        elif choice == "2" and "hanzo" not in victories:
            if fight_hanzo():
                victories.add("hanzo")
                break
        elif choice == "3" and "vanilka" not in victories:
            if fight_vanilka():
                victories.add("vanilka")
                break
        elif choice == "4":
            break
        else:
            print("Неверный выбор или сценарий уже исследован. Попробуйте снова.")


if __name__ == "__main__":
    main()
